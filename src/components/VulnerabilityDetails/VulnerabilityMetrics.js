import React from 'react';
import { Grid, Card, CardContent, Typography } from '@mui/material';
import { SparkLineChart } from '@mui/x-charts/SparkLineChart';

function VulnerabilityMetrics() {
  // Generate different data patterns for each sparkline
  const criticalVulnData = Array.from(
    { length: 30 },
    (_, i) => Math.floor(Math.random() * 8) + 2 // Critical vulnerabilities
  );
  const highVulnData = Array.from(
    { length: 30 },
    (_, i) => Math.floor(Math.random() * 15) + 5 // High vulnerabilities
  );
  const mediumVulnData = Array.from(
    { length: 30 },
    (_, i) => Math.floor(Math.random() * 25) + 10 // Medium vulnerabilities
  );
  const lowVulnData = Array.from(
    { length: 30 },
    (_, i) => Math.floor(Math.random() * 40) + 15 // Low vulnerabilities
  );
  const patchComplianceData = Array.from(
    { length: 30 },
    (_, i) => 85 + Math.sin(i / 6) * 10 + Math.random() * 5 // Patch compliance %
  );
  const securityScoreData = Array.from(
    { length: 30 },
    (_, i) => 75 + Math.cos(i / 8) * 15 + Math.random() * 5 // Security score
  );
  const scanCoverageData = Array.from(
    { length: 30 },
    (_, i) => 92 + Math.sin(i / 7) * 6 + Math.random() * 3 // Scan coverage %
  );
  const remedationTimeData = Array.from(
    { length: 30 },
    (_, i) => 15 + Math.floor(Math.random() * 10) // Average remediation time in days
  );

  const cards = [
    {
      title: 'Critical Vulnerabilities',
      value: '5',
      trend: '-20%',
      data: criticalVulnData,
      color: 'error.main',
    },
    {
      title: 'High Vulnerabilities',
      value: '12',
      trend: '-8%',
      data: highVulnData,
      color: 'warning.main',
    },
    {
      title: 'Medium Vulnerabilities',
      value: '23',
      trend: '+5%',
      data: mediumVulnData,
      color: 'info.main',
    },
    {
      title: 'Low Vulnerabilities',
      value: '34',
      trend: '+12%',
      data: lowVulnData,
      color: 'success.main',
    },
    {
      title: 'Patch Compliance',
      value: '89.2%',
      trend: '+3%',
      data: patchComplianceData,
      color: 'primary.main',
    },
    {
      title: 'Security Score',
      value: '82.5',
      trend: '+6%',
      data: securityScoreData,
      color: 'success.main',
    },
    {
      title: 'Scan Coverage',
      value: '94.8%',
      trend: '+2%',
      data: scanCoverageData,
      color: 'info.main',
    },
    {
      title: 'Avg Remediation Time',
      value: '18 days',
      trend: '-15%',
      data: remedationTimeData,
      color: 'warning.main',
    },
  ];

  return (
    <Grid container spacing={3}>
      {cards.map((card, index) => (
        <Grid size={{ xs: 12, sm: 6, md: 4, lg: 3 }} key={index}>
          <Card sx={{ height: '100%' }}>
            <CardContent>
              <Typography variant='h6' gutterBottom>
                {card.title}
              </Typography>
              <Typography variant='h4' sx={{ my: 1 }}>
                {card.value}
              </Typography>
              <Typography
                variant='body2'
                color={
                  card.trend.startsWith('+') ? 'success.main' : 'error.main'
                }
                sx={{ mb: 2 }}
              >
                {card.trend}
              </Typography>
              <SparkLineChart
                data={card.data}
                curve='natural'
                area={true}
                colors={[card.color]}
                showTooltip
              />
            </CardContent>
          </Card>
        </Grid>
      ))}
    </Grid>
  );
}

export default VulnerabilityMetrics;
