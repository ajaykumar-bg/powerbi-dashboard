// Utility functions for Vulnerability Details components

export function createData(
  vulnId,
  title,
  severity,
  cvssScore,
  affectedAsset,
  status,
  discoveredDate,
  daysOpen
) {
  return {
    vulnId,
    title,
    severity,
    cvssScore,
    affectedAsset,
    status,
    discoveredDate,
    daysOpen,
  };
}

export function getVulnerabilitySeverityColor(severity) {
  switch (severity.toLowerCase()) {
    case 'critical':
      return 'error';
    case 'high':
      return 'warning';
    case 'medium':
      return 'info';
    case 'low':
      return 'success';
    default:
      return 'default';
  }
}

export function getVulnerabilityStatusColor(status) {
  switch (status.toLowerCase()) {
    case 'open':
      return 'error';
    case 'in progress':
      return 'warning';
    case 'resolved':
      return 'success';
    default:
      return 'default';
  }
}

// Mock vulnerability data
export const VULNERABILITY_DATA = [
  createData(
    'CVE-2024-0001',
    'SQL Injection in User Authentication Module',
    'Critical',
    9.8,
    'Auth Service API',
    'Open',
    '2024-08-15',
    32
  ),
  createData(
    'CVE-2024-0002',
    'Cross-Site Scripting (XSS) in Dashboard',
    'High',
    7.4,
    'Web Application',
    'In Progress',
    '2024-08-20',
    27
  ),
  createData(
    'CVE-2024-0003',
    'Insecure Direct Object References',
    'High',
    8.1,
    'API Gateway',
    'Open',
    '2024-08-25',
    22
  ),
  createData(
    'CVE-2024-0004',
    'Missing Input Validation in File Upload',
    'Medium',
    6.5,
    'File Upload Service',
    'Resolved',
    '2024-07-10',
    0
  ),
  createData(
    'CVE-2024-0005',
    'Weak Password Policy Implementation',
    'Medium',
    5.8,
    'User Management',
    'Open',
    '2024-09-01',
    15
  ),
  createData(
    'CVE-2024-0006',
    'Information Disclosure in Error Messages',
    'Low',
    3.7,
    'API Responses',
    'In Progress',
    '2024-08-30',
    17
  ),
  createData(
    'CVE-2024-0007',
    'Insufficient Session Timeout',
    'Medium',
    4.9,
    'Session Manager',
    'Open',
    '2024-09-05',
    11
  ),
  createData(
    'CVE-2024-0008',
    'Privilege Escalation in Admin Panel',
    'Critical',
    9.1,
    'Admin Interface',
    'Open',
    '2024-09-10',
    6
  ),
  createData(
    'CVE-2024-0009',
    'Unvalidated Redirects and Forwards',
    'Low',
    4.3,
    'Web Application',
    'Resolved',
    '2024-07-25',
    0
  ),
  createData(
    'CVE-2024-0010',
    'Insecure Cryptographic Storage',
    'High',
    7.8,
    'Database Server',
    'In Progress',
    '2024-08-18',
    29
  ),
];

export const getSortedVulnerabilityData = (
  vulnerabilityData,
  orderBy,
  order
) => {
  return [...vulnerabilityData].sort((a, b) => {
    let aValue = a[orderBy];
    let bValue = b[orderBy];

    // Handle different data types
    if (orderBy === 'cvssScore' || orderBy === 'daysOpen') {
      aValue = Number(aValue);
      bValue = Number(bValue);
    } else if (orderBy === 'discoveredDate') {
      aValue = new Date(aValue);
      bValue = new Date(bValue);
    } else {
      aValue = String(aValue).toLowerCase();
      bValue = String(bValue).toLowerCase();
    }

    if (order === 'asc') {
      return aValue < bValue ? -1 : aValue > bValue ? 1 : 0;
    } else {
      return aValue > bValue ? -1 : aValue < bValue ? 1 : 0;
    }
  });
};
